╔═════════════════════════════════════════════════════════════════════════════════╗
║ STEP 245  │  R: 0.82  │  KL: 0.023  │  ⚡ 142 tok/s                             ║
╚═════════════════════════════════════════════════════════════════════════════════╝

DECODE LIVE                                              Cache: 128/2048
─────────────────────────────────────────────────────────────────────────────────
Tok[23]: "Paris"  p=0.89  ←━━━━━━━━━━━━━━━━━━━━━ SAMPLING NOW ⚡

  ┌─ mRoPE ──┐    ┌─ Q/K/V ─┐    ┌─ Attn ──┐    ┌─ KV ────┐
  │ T: 0     │ →  │ L28 H12 │ →  │ █▓▒░    │ →  │ WRITE   │
  │ H: 4     │    │ Q [64d] │    │ ░▒▓█    │    │ +16 tok │
  │ W: 4     │    │ K [64d] │    │ ▒▓█░    │    │ L: 144  │
  └──────────┘    └─────────┘    └─────────┘    └─────────┘

ATTENTION FLOW (Last 6 Layers × 16 Heads)               [█ = high activity]
─────────────────────────────────────────────────────────────────────────────────
L24  ░░▒█▓░░▒▓██░░▒░  │  ← Text self-attn
L25  ▒▓██░░▒░░▓█▒░░▒  │
L26  ░▒▓█████▓▒░░░░▒  │  ← Vision→Text cross-attn peak  ⚡ ACTIVE
L27  ░░░▒▓█▓▒░░▒▓█░░  │
L28  ▓█░░░▒▓█░░░▒▓█░  │
L29  ░▒▓█░░░▒▓█░░░▒▓  │  ← Output layer

VISION INJECTION @ Token[3]                         256 vis tokens merged
─────────────────────────────────────────────────────────────────────────────────
[The] [cat] [<IMG>░░░░▓▓▓███▓▓▓░░░░] [sits] [on] [the]
  0.02  0.15   ██████████████████    0.08  0.42 0.21

TOKEN CREDIT                                        [Gradient × LogProb]
─────────────────────────────────────────────────────────────────────────────────
"Paris"     █████████  0.89   ← HIGH IMPACT  ⚡
"France"    ▓▓▓▓▓▓     0.42
"capital"   ▒▒▒▒       0.18
"located"   ▒▒▒▒       0.21
"of"        ░          0.01

KV CACHE MEMORY                                   Grouped-Query: 4 heads
─────────────────────────────────────────────────────────────────────────────────
L24: [████████░░░░░░░░░░░░░░░░░░░░] 144/2048  32KB  ⚡ ACTIVE
L25: [████████░░░░░░░░░░░░░░░░░░░░] 144/2048  32KB  ⚡ ACTIVE
L26: [████████░░░░░░░░░░░░░░░░░░░░] 144/2048  32KB  ⚡ ACTIVE
L27: [████████░░░░░░░░░░░░░░░░░░░░] 144/2048  32KB  ⚡ ACTIVE
L28: [████████░░░░░░░░░░░░░░░░░░░░] 144/2048  32KB  ⚡ ACTIVE
L29: [████████░░░░░░░░░░░░░░░░░░░░] 144/2048  32KB  ⚡ ACTIVE

[P] Pause │ [S] Step │ [L] Layers │ [Q] Quit                       GPU: 82%

═════════════════════════════════════════════════════════════════════════════════
FRAME 2 (Next token decode step - FLASHING UPDATE)
═════════════════════════════════════════════════════════════════════════════════

╔═════════════════════════════════════════════════════════════════════════════════╗
║ STEP 245  │  R: 0.82  │  KL: 0.023  │  ⚡ 143 tok/s                             ║
╚═════════════════════════════════════════════════════════════════════════════════╝

DECODE LIVE                                              Cache: 144/2048
─────────────────────────────────────────────────────────────────────────────────
Tok[24]: ","  p=0.67  ←━━━━━━━━━━━━━━━━━━━━━━━ SAMPLING NOW ⚡

  ┌─ mRoPE ──┐    ┌─ Q/K/V ─┐    ┌─ Attn ──┐    ┌─ KV ────┐
  │ T: 0     │ →  │ L28 H8  │ →  │ ▓█▒░    │ →  │ WRITE   │
  │ H: 4     │    │ Q [64d] │    │ ░░▒▓    │    │ +1 tok  │
  │ W: 4     │    │ K [64d] │    │ ▒░░▓    │    │ L: 145  │
  └──────────┘    └─────────┘    └─────────┘    └─────────┘

ATTENTION FLOW (Last 6 Layers × 16 Heads)               [█ = high activity]
─────────────────────────────────────────────────────────────────────────────────
L24  ▒░░▒█░░▓░██░▒░░  │  ← Text self-attn
L25  ░▓█░░░▒▓░▓█░▒▒░  │
L26  ▒░▓█▒▒▒▓░░░▒░░▒  │  ← Vision→Text fading
L27  ░▒░▒▓█▓░░▒▓░░░░  │
L28  ▓░░█░▒▓█▒░░▓█░░  │  ⚡ ACTIVE
L29  ░░▓█░▒░▒▓░░░░▒▓  │  ← Output layer

VISION INJECTION @ Token[3]                         256 vis tokens merged
─────────────────────────────────────────────────────────────────────────────────
[The] [cat] [<IMG>░░░░▒▒▓██▓▓▒░░░░] [sits] [on] [the] [Paris]
  0.02  0.15   ████████████████    0.08  0.42 0.21  0.89

TOKEN CREDIT                                        [Gradient × LogProb]
─────────────────────────────────────────────────────────────────────────────────
","         ▓▓▓▓▓▓     0.67   ← CURRENT  ⚡
"Paris"     █████████  0.89
"France"    ▓▓▓▓▓      0.42
"capital"   ▒▒▒        0.18
"located"   ▒▒▒        0.21

KV CACHE MEMORY                                   Grouped-Query: 4 heads
─────────────────────────────────────────────────────────────────────────────────
L24: [████████░░░░░░░░░░░░░░░░░░░░] 145/2048  33KB  ⚡ WRITE
L25: [████████░░░░░░░░░░░░░░░░░░░░] 145/2048  33KB  ⚡ WRITE
L26: [████████░░░░░░░░░░░░░░░░░░░░] 145/2048  33KB  ⚡ WRITE
L27: [████████░░░░░░░░░░░░░░░░░░░░] 145/2048  33KB  ⚡ WRITE
L28: [████████░░░░░░░░░░░░░░░░░░░░] 145/2048  33KB  ⚡ WRITE
L29: [████████░░░░░░░░░░░░░░░░░░░░] 145/2048  33KB  ⚡ WRITE

[P] Pause │ [S] Step │ [L] Layers │ [Q] Quit                       GPU: 84%

═════════════════════════════════════════════════════════════════════════════════
FRAME 3 (Training step complete - ALL METRICS UPDATE)
═════════════════════════════════════════════════════════════════════════════════

╔═════════════════════════════════════════════════════════════════════════════════╗
║ STEP 246  │  R: 0.85  │  KL: 0.021  │  ⚡ 145 tok/s                             ║
╚═════════════════════════════════════════════════════════════════════════════════╝

DECODE LIVE                                              Cache: 0/2048
─────────────────────────────────────────────────────────────────────────────────
Tok[0]: "<|im_start|>"  p=1.00  ←━━━━━━━━━━━━ NEW EPISODE STARTING ⚡

  ┌─ mRoPE ──┐    ┌─ Q/K/V ─┐    ┌─ Attn ──┐    ┌─ KV ────┐
  │ T: 0     │ →  │ L0  H0  │ →  │ ░░░░    │ →  │ INIT    │
  │ H: 0     │    │ Q [64d] │    │ ░░░░    │    │ +0 tok  │
  │ W: 0     │    │ K [64d] │    │ ░░░░    │    │ L: 0    │
  └──────────┘    └─────────┘    └─────────┘    └─────────┘

ATTENTION FLOW (Last 6 Layers × 16 Heads)               [█ = high activity]
─────────────────────────────────────────────────────────────────────────────────
L24  ░░░░░░░░░░░░░░░░  │  ← RESET
L25  ░░░░░░░░░░░░░░░░  │
L26  ░░░░░░░░░░░░░░░░  │
L27  ░░░░░░░░░░░░░░░░  │
L28  ░░░░░░░░░░░░░░░░  │
L29  ░░░░░░░░░░░░░░░░  │

VISION INJECTION @ Token[?]                         awaiting vision input...
─────────────────────────────────────────────────────────────────────────────────
[Prompt preparing...]

TOKEN CREDIT                                        [Gradient × LogProb]
─────────────────────────────────────────────────────────────────────────────────
Episode complete! Reward: 0.85  ⚡ PPO UPDATE APPLIED
Previous episode tokens: 24
Mean credit: 0.28 | Max credit: 0.89 @ token[23]

KV CACHE MEMORY                                   Grouped-Query: 4 heads
─────────────────────────────────────────────────────────────────────────────────
L24: [░░░░░░░░░░░░░░░░░░░░░░░░░░░░] 0/2048    0KB   CLEARED
L25: [░░░░░░░░░░░░░░░░░░░░░░░░░░░░] 0/2048    0KB   CLEARED
L26: [░░░░░░░░░░░░░░░░░░░░░░░░░░░░] 0/2048    0KB   CLEARED
L27: [░░░░░░░░░░░░░░░░░░░░░░░░░░░░] 0/2048    0KB   CLEARED
L28: [░░░░░░░░░░░░░░░░░░░░░░░░░░░░] 0/2048    0KB   CLEARED
L29: [░░░░░░░░░░░░░░░░░░░░░░░░░░░░] 0/2048    0KB   CLEARED

[P] Pause │ [S] Step │ [L] Layers │ [Q] Quit                       GPU: 79%


═════════════════════════════════════════════════════════════════════════════════
COLOR LEGEND & ANIMATION NOTES
═════════════════════════════════════════════════════════════════════════════════

Intensity Ramp:
  ░ = 0.00-0.25  (dim gray / ANSI 240)
  ▒ = 0.25-0.50  (gray / ANSI 244)
  ▓ = 0.50-0.75  (bright / ANSI 248)
  █ = 0.75-1.00  (white / ANSI 255)

Flashing Indicators:
  ⚡ ACTIVE    - Yellow flash (ANSI 226) at 5Hz
  ⚡ WRITE     - Green flash (ANSI 46) at 5Hz
  ⚡ SAMPLING  - Cyan flash (ANSI 51) at 5Hz

Update Frequency:
  - Decode step: 10-50 Hz (each new token)
  - Attention flow: Every forward pass through layer
  - KV cache: On every cache.update() call
  - Token credit: End of episode
  - Top header: Every training step

Implementation Notes:
  - Use ANSI escape codes for color: \033[38;5;XXXm
  - Clear screen with \033[2J\033[H
  - Cursor manipulation for smooth updates
  - Double buffering to avoid flicker
  - Thread-safe queue for updates from JAX
